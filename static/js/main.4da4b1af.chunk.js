(this["webpackJsonpmvm-web"]=this["webpackJsonpmvm-web"]||[]).push([[0],{258:function(e,a,t){e.exports=t(378)},378:function(e,a,t){"use strict";t.r(a);t(259);var n,r,o=t(0),i=t.n(o),c=t(16),l=t.n(c),s=t(433),u=t(428),m=t(237),d=t(55),p=t(79),h=t(22),f=t(20),E=t(156),g=t.n(E),b=t(213),w=t(80),S=t.n(w),v=function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e)try{a?localStorage.setItem("token",e):sessionStorage.setItem("token",e)}catch(t){console.error("Local Storage not supported")}},O=function(){try{localStorage.removeItem("token"),sessionStorage.removeItem("token")}catch(e){console.error("Local Storage not supported")}},R={isLoading:!0,username:"",role:4,needNewPassword:!1,refreshToken:""},C=Object(o.createContext)(R),I=function(){return Object(o.useContext)(C)},T=function(e){var a=Object(o.useState)(R),t=Object(f.a)(a,2),n=t[0],r=t[1];Object(o.useEffect)((function(){window.requestIdleCallback((function(){g.a.getPromise({preprocessor:function(e,a){if("userAgent"===e){var t=new b.UAParser(a);return((t.getDevice().model||"")+" "+(t.getDevice().type||"")+" "+(t.getDevice().vendor||"")+" "+(t.getOS().name||"")+" "+(t.getOS().version||"")+" "+(t.getBrowser().name||"")+" "+(t.getEngine().name||"")+" "+(t.getCPU().architecture||"")).trim()}return a}}).then((function(e){var a,t,n=e.map((function(e){return e.value})),o=g.a.x64hash128(n.join(""),31);(a=o,new Promise((function(e,n){var r="",o=!0;try{(r=String(localStorage.getItem("token")||""))||(o=!1,r=String(sessionStorage.getItem("token")||""))}catch(c){o=!1,console.error("Local Storage not supported")}if(r){var i={method:"GET",url:"".concat("https://virtusloop-mvm-api.herokuapp.com/").concat("api/auth/me/"),headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8",Authorization:"Bearer ".concat(r),"X-Browser-Hash":a}};t&&(i.headers["X-Refresh-Token"]=t),S()(i).then((function(a){if(a&&200===a.status){var t=a.headers["x-token"],r=a.headers["x-refresh-token"];v(t,o),e({username:a.data.username,role:a.data.role,needNewPassword:a.data.needNewPassword,refreshToken:r})}else O(),n()})).catch((function(){O(),n()}))}else n()}))).then((function(e){r(Object(h.a)({},e,{isLoading:!1,browserHash:o}))})).catch((function(){r(Object(h.a)({},R,{isLoading:!1,browserHash:o}))}))}))}))}),[]);var c=Object(o.useMemo)((function(){return Object(h.a)({},n,{updateAuthData:function(e){return r(Object(h.a)({},n,{},e))},onLogin:function(e){return r(e)},onLogout:function(e){return r(Object(h.a)({},R,{isLoading:!1,browserHash:e}))},setLoading:function(e){return r(Object(h.a)({},n,{isLoading:e}))}})}),[n]);return i.a.createElement(C.Provider,Object.assign({value:c},e))},N=t(181),A=function(){return i.a.createElement("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",backgroundColor:"#F7FAFC"}},i.a.createElement(N.a,{disableShrink:!0,size:70}))},k=t(443),P=t(201),y=t(434),j=t(435),D=t(212),L=t(206),x=t(209),H=t(234),U=t.n(H),B=t(57),W=t(219),F=t(432),_=t(95),z=t.n(_),G=t(419),M=function(){return i.a.createElement(B.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",i.a.createElement(G.a,{color:"inherit",href:"https://material-ui.com/"},"Your Website")," ".concat((new Date).getFullYear(),"."))},q=t(122),V=t(3),X=t(17),Y=t(429),J=t(436),Z=t(187),$=t(184),K=t(437),Q=t(444),ee=t(438),ae=t(423),te=t(390),ne=t(439),re=t(204),oe=t(440),ie=t(224),ce=t.n(ie),le=t(225),se=t.n(le),ue=t(226),me=t.n(ue),de=t(227),pe=t.n(de),he=t(228),fe=t.n(he),Ee=t(229),ge=t.n(Ee),be=t(230),we=t.n(be),Se=t(231),ve=t.n(Se),Oe=t(232),Re=t.n(Oe),Ce=t(233),Ie=t.n(Ce),Te=t(425),Ne=t(430),Ae=t(426),ke=t(431),Pe=t(427),ye=t(442),je=t(441),De=t(157),Le=t.n(De),xe=t(134),He=t(135),Ue=function(){function e(){Object(xe.a)(this,e)}return Object(He.a)(e,null,[{key:"GET",value:function(a,t,n){return new Promise((function(r,o){var i=e.getToken(),c=Object(f.a)(i,2),l=c[0],s=c[1];l?e.makeRequest(a,"GET",l,t,n,s).then((function(e){return r(e)})).catch((function(){return o()})):o()}))}},{key:"POST",value:function(a,t,n,r){return new Promise((function(o,i){var c=e.getToken(),l=Object(f.a)(c,2),s=l[0],u=l[1];s?e.makeRequest(a,"POST",s,t,n,u,r).then((function(e){return o(e)})).catch((function(){return i()})):i()}))}},{key:"PUT",value:function(a,t,n,r){return new Promise((function(o,i){var c=e.getToken(),l=Object(f.a)(c,2),s=l[0],u=l[1];s?e.makeRequest(a,"PUT",s,t,n,u,r).then((function(e){return o(e)})).catch((function(){return i()})):i()}))}},{key:"DELETE",value:function(a,t,n,r){return new Promise((function(o,i){var c=e.getToken(),l=Object(f.a)(c,2),s=l[0],u=l[1];s?e.makeRequest(a,"DELETE",s,t,n,u,r).then((function(e){return o(e)})).catch((function(){return i()})):i()}))}},{key:"makeRequest",value:function(a,t,n,r,o,i,c){return new Promise((function(l,s){var u={method:t,url:a,headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8",Authorization:"Bearer ".concat(n),"X-Refresh-Token":r,"X-Browser-Hash":o},data:c};S()(u).then((function(a){if(200===(null===a||void 0===a?void 0:a.status)||201===(null===a||void 0===a?void 0:a.status)){var t=a.headers["x-token"],n=a.headers["x-refresh-token"];e.addAuth(t,i),l({data:a.data,refreshToken:n})}else s()})).catch((function(){s()}))}))}},{key:"getToken",value:function(){var e="",a=!0;try{(e=String(localStorage.getItem("token")||""))||(a=!1,e=String(sessionStorage.getItem("token")||""))}catch(t){a=!1,console.error("Local Storage not supported")}return[e,a]}},{key:"addAuth",value:function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e)try{a?localStorage.setItem("token",e):sessionStorage.setItem("token",e)}catch(t){console.error("Local Storage not supported")}}}]),e}(),Be=t(6),We=Object(Be.a)({root:{color:"#C53030","&:hover":{background:"rgba(197, 47, 48, 0.08)"}}})(P.a),Fe=t(236),_e=t(220),ze=t(238),Ge=t(200),Me=t(211),qe=t(188),Ve=t(202),Xe=t(221),Ye=t.n(Xe),Je=t(222),Ze=t.n(Je),$e=function(e){function a(e){var t;return Object(xe.a)(this,a),(t=Object(Fe.a)(this,Object(_e.a)(a).call(this,e))).handleClickShowAddPassword=function(){t.setState({showAddPassword:!t.state.showAddPassword})},t.handleMouseDownPassword=function(e){e.preventDefault()},t.state={showAddPassword:!0,password:e.initialPassword},t}return Object(ze.a)(a,e),Object(He.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement(Ge.a,{style:this.props.formStyle},this.props.label&&i.a.createElement(Me.a,{htmlFor:"passwordInput"},this.props.label),i.a.createElement(qe.a,{style:this.props.inputStyle,id:"passwordInput",type:this.state.showAddPassword?"text":"password",autoComplete:"new-password",placeholder:this.props.placeholder,value:this.state.password,onChange:function(a){e.setState({password:a.target.value}),e.props.onChange&&e.props.onChange(a.target.value)},endAdornment:i.a.createElement(Ve.a,{position:"end"},i.a.createElement($.a,{"aria-label":"toggle password visibility",onClick:this.handleClickShowAddPassword,onMouseDown:this.handleMouseDownPassword},this.state.showAddPassword?i.a.createElement(Ye.a,null):i.a.createElement(Ze.a,null)))}))}},{key:"password",get:function(){return this.state.password}}]),a}(i.a.Component);!function(e){e[e.ADMINISTRATOR=1]="ADMINISTRATOR",e[e.MODERATOR=2]="MODERATOR",e[e.AGENT=3]="AGENT",e[e.TEHNICIAN=4]="TEHNICIAN",e[e.FILLER=5]="FILLER"}(n||(n={})),function(e){e[e.FAILURE=0]="FAILURE",e[e.SUCCESS=1]="SUCCESS"}(r||(r={}));var Ke,Qe=function(e){var a={};return Object.keys(e).filter((function(e){return!1===isNaN(Number(e))})).forEach((function(t){return a[parseInt(t)]=e[t]})),a},ea={isOpen:!1,message:"",status:r.SUCCESS},aa={isOpen:!1,rowData:{}},ta=function(e){return i.a.createElement(je.a,Object.assign({elevation:6,variant:"filled"},e))},na=function(){var e=I(),a=e.username,t=e.role,c=e.refreshToken,l=e.browserHash,s=void 0===l?"":l,u=e.updateAuthData,m=Object(o.useState)(ea),d=Object(f.a)(m,2),p=d[0],E=d[1],g=function(e,a){"clickaway"!==a&&E(Object(h.a)({},p,{isOpen:!1,message:""}))},b=function(e,a){E(Object(h.a)({},p,{isOpen:!0,status:e,message:a}))},w=function(e){b(r.SUCCESS,e)},S=function(e){b(r.FAILURE,e)},v=Object(o.useRef)(null),O=Object(o.useState)(aa),R=Object(f.a)(O,2),C=R[0],T=R[1],N=function(e){return function(){T(Object(h.a)({},C,{rowData:e,isOpen:!0}))}},A=function(e){return function(){if(e){var a,t,n=null!==(a=null===(t=v.current)||void 0===t?void 0:t.password)&&void 0!==a?a:"",r="".concat("https://virtusloop-mvm-api.herokuapp.com/").concat("api/users/reset_password/").concat(C.rowData.username);Ue.PUT(r,c,s,{newPassword:n}).then((function(e){u&&u({refreshToken:e.refreshToken,browserHash:s}),T(Object(h.a)({},aa)),w("Parola resetata cu success!")})).catch((function(){T(Object(h.a)({},aa)),S("Parola nu a putut fi resetata!")}))}T(aa)}},k=Object(o.useState)({columns:[{title:"Nume",field:"username",cellStyle:{maxWidth:90}},{title:"Parola",field:"password",editable:"onAdd",cellStyle:{maxWidth:90,minWidth:180},sorting:!1,searchable:!1,editComponent:function(e){return i.a.createElement($e,{formStyle:{minWidth:150,maxWidth:"70%"},inputStyle:{fontSize:13},placeholder:"Parola initiala",initialPassword:"",onChange:e.onChange})}},{title:"Rol",field:"role",lookup:Qe(n),initialEditValue:n.FILLER,defaultSort:"asc",customSort:function(e,a){return e.role-a.role}},{title:"Ultima modificare",field:"updated",editable:"never",initialEditValue:(new Date).toLocaleString("ro-RO")}],data:[],localization:{grouping:{groupedBy:"Grupeaza dupa:",placeholder:"Muta capetele de table pentru a le grupa"},pagination:{labelDisplayedRows:"{from}-{to} din {count}",labelRowsPerPage:"Randuri pe pagina:",labelRowsSelect:"randuri"},toolbar:{},header:{actions:"Actiuni"},body:{filterRow:{},editRow:{saveTooltip:"Salvare",cancelTooltip:"Anulare",deleteText:"Esti sigur ca vrei sa stergi aceasta persoana?"},addTooltip:"Adaugare persoana noua",deleteTooltip:"Sterge",editTooltip:"Modifica"}}}),y=Object(f.a)(k,1)[0],j=function(e){return t<e.role&&e.username!==a},D=function(e){var n;return!e||("update"===(null===(n=e.tableData)||void 0===n?void 0:n.editing)||(t>=e.role||e.username===a))};return i.a.createElement("div",null,i.a.createElement(Le.a,{title:"Personal",columns:y.columns,data:function(e){return new Promise((function(a,t){var n=e.search?"?search=".concat(e.search,"&page=").concat(e.page,"&pageSize=").concat(e.pageSize):"?page=".concat(e.page,"&pageSize=").concat(e.pageSize),r="".concat("https://virtusloop-mvm-api.herokuapp.com/").concat("api/users/").concat(n);Ue.GET(r,c,s).then((function(e){u&&u({refreshToken:e.refreshToken,browserHash:s});var t={data:e.data[0],page:+e.data[1].page,totalCount:+e.data[1].totalCount};t.data.forEach((function(e){return e.updated=new Date(e.updated).toLocaleString("ro-RO",{timeZone:"Etc/GMT-4"})})),a(t)})).catch((function(){S("A intervenit o problema la incarcarea utilizatorilor!"),a({data:[],page:0,totalCount:0})}))}))},localization:y.localization,options:{draggable:!1,pageSize:10,padding:"default",actionsColumnIndex:4,headerStyle:{maxWidth:90},debounceInterval:300},actions:[function(e){return{icon:"lock_open",tooltip:"Resetare parola",onClick:N(e),disabled:D(e)}}],components:{EditField:function(e){return"role"===e.columnDef.field&&(e.columnDef.lookup=function(e){var a=Qe(n);return Object.keys(a).forEach((function(t){e>=parseInt(t)&&delete a[parseInt(t)]})),a}(t)),i.a.createElement(De.MTableEditField,e)}},editable:{isEditable:function(e){return j(e)},isDeletable:function(e){return j(e)},onRowAdd:function(e){return new Promise((function(a){var t="".concat("https://virtusloop-mvm-api.herokuapp.com/").concat("api/users/");Ue.POST(t,c,s,{username:e.username,password:e.password,role:+e.role}).then((function(e){u&&u({refreshToken:e.refreshToken,browserHash:s}),w("Utilizator adaugat cu succes!"),a()})).catch((function(){S("A intervenit o problema la adaugarea utilizatorului!"),a()}))}))},onRowUpdate:function(e,a){return new Promise((function(t){var n="".concat("https://virtusloop-mvm-api.herokuapp.com/").concat("api/users/").concat(null===a||void 0===a?void 0:a.username);Ue.PUT(n,c,s,{username:e.username,role:+e.role}).then((function(e){u&&u({refreshToken:e.refreshToken,browserHash:s}),w("Utilizator modificat cu succes!"),t()})).catch((function(){S("A intervenit o problema la modificarea utilizatorului!"),t()}))}))},onRowDelete:function(e){return new Promise((function(a){var t="".concat("https://virtusloop-mvm-api.herokuapp.com/").concat("api/users/").concat(e.username);Ue.DELETE(t,c,s).then((function(e){u&&u({refreshToken:e.refreshToken,browserHash:s}),w("Utilizator sters cu succes!"),a()})).catch((function(){S("A intervenit o problema la stergerea utilizatorului!"),a()}))}))}}}),i.a.createElement(Te.a,{open:C.isOpen,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",disableBackdropClick:!0,disableScrollLock:!0},i.a.createElement(Ne.a,{id:"alert-dialog-title"},"Resetare parola pentru ".concat(C.rowData.username)),i.a.createElement(Ae.a,null,i.a.createElement(ke.a,{id:"alert-dialog-description"},"Parola contului va fi resetata cu o noua parola definita, iar la prima autentificare utilizatorul va trebui sa isi seteze o noua parola.")),i.a.createElement($e,{ref:v,formStyle:{margin:"0 auto 10px",maxWidth:"80%"},label:"Noua parola",initialPassword:""}),i.a.createElement(Pe.a,{style:{justifyContent:"space-around"}},i.a.createElement(We,{onClick:A(!1)},"Renunta"),i.a.createElement(P.a,{onClick:A(!0),color:"primary"},"Reseteaza"))),i.a.createElement(ye.a,{open:p.isOpen,autoHideDuration:6e3,onClose:g},i.a.createElement(ta,{onClose:g,severity:p.status===r.SUCCESS?"success":"error"},p.message)))},ra=Object(W.a)((function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},card:{minWidth:275},paper:{marginTop:e.spacing(2),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));!function(e){e[e.INITIAL=-1]="INITIAL",e[e.SERVER_ERROR=0]="SERVER_ERROR",e[e.CLIENT_ERROR=1]="CLIENT_ERROR",e[e.SUCCESS=2]="SUCCESS"}(Ke||(Ke={}));var oa,ia=function(){var e=ra(),a=I(),t=a.browserHash,n=void 0===t?"":t,r=a.refreshToken,c=a.onLogin,l=Object(o.useState)(Ke.INITIAL),u=Object(f.a)(l,2),m=u[0],d=u[1],p=Object(o.useState)(!1),E=Object(f.a)(p,2),g=E[0],b=E[1];return i.a.createElement(F.a,{component:"main",maxWidth:"xs"},i.a.createElement(s.a,null),i.a.createElement("div",{className:e.paper},i.a.createElement("form",{className:e.form,onSubmit:function(e){e.preventDefault();var a=new FormData(e.currentTarget),t=String(a.get("oldPassword")||""),o=String(a.get("newPassword1")||""),i=String(a.get("newPassword2")||"");o===i?(b(!0),function(e,a,t,n){return new Promise((function(r,o){var i="",c=!0;try{(i=String(localStorage.getItem("token")||""))||(c=!1,i=String(sessionStorage.getItem("token")||""))}catch(s){c=!1,console.error("Local Storage not supported")}if(i){var l={method:"POST",url:"".concat("https://virtusloop-mvm-api.herokuapp.com/").concat("api/auth/change_password/"),headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8",Authorization:"Bearer ".concat(i),"X-Refresh-Token":n,"X-Browser-Hash":t},data:{oldPassword:e,newPassword:a}};S()(l).then((function(e){if(e&&201===e.status){var a=e.headers["x-token"],t=e.headers["x-refresh-token"];v(a,c),r({username:e.data.username,role:e.data.role,needNewPassword:e.data.needNewPassword,refreshToken:t})}else o()})).catch((function(){o()}))}else o()}))}(t,i,n,r).then((function(e){b(!1),d(Ke.SUCCESS),c&&c(Object(h.a)({},e,{browserHash:n}))})).catch((function(){b(!1),d(Ke.SERVER_ERROR)}))):d(Ke.CLIENT_ERROR)}},i.a.createElement(D.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"oldPassword",label:"Vechea parola",type:"password",id:"oldPassword",autoComplete:"current-password",onChange:function(){return d(Ke.INITIAL)},disabled:g}),i.a.createElement(D.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"newPassword1",label:"Noua parola",type:"password",id:"newPassword1",autoComplete:"new-password",onChange:function(){return d(Ke.INITIAL)},disabled:g}),i.a.createElement(D.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"newPassword2",label:"Reintrodueti noua parola",type:"password",id:"newPassword2",autoComplete:"new-password",onChange:function(){return d(Ke.INITIAL)},disabled:g}),m!==Ke.INITIAL&&i.a.createElement(y.a,{className:e.card},i.a.createElement(j.a,null,i.a.createElement(B.a,{variant:"body1",component:"p",color:m===Ke.SUCCESS?"primary":"error"},m===Ke.SUCCESS?"Parola schimbata cu succes!":m===Ke.SERVER_ERROR?"Nu s-a putut schimba parola! Verifica vechea parola si incearca din nou.":"Noua parola nu este identica la reintroducere!"))),i.a.createElement(P.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit,disabled:g},g?i.a.createElement(z.a,null):"Schimbare parola"))))},ca=Object(W.a)((function(e){return{root:{display:"flex"},toolbar:{paddingRight:24},toolbarIcon:Object(h.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px"},e.mixins.toolbar),appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:240,width:"calc(100% - ".concat(240,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},menuButtonHidden:{display:"none"},title:{flexGrow:1},drawerPaper:{position:"relative",whiteSpace:"nowrap",width:240,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerPaperClose:Object(q.a)({overflowX:"hidden",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),width:e.spacing(7)},e.breakpoints.up("sm"),{width:e.spacing(9)}),appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"},fixedHeight:{height:240}}}));!function(e){e.HOME="/",e.LOGIN="/login",e.NEW_PASSWORD="/new_password",e.DASHBOARD="/dashboard",e.MACHINES="/machines",e.INGREDIENTS="/ingredients",e.LOCATIONS="/locations",e.USERS="/users",e.CHANGE_PASSWORD="/change_password",e.FORBIDDEN="/forbidden",e.NOT_FOUND="/404",e.TEMPORARY="/temporary"}(oa||(oa={}));var la,sa=new Map([[oa.DASHBOARD,"Panou principal"],[oa.MACHINES,"Aparate"],[oa.INGREDIENTS,"Ingrediente"],[oa.LOCATIONS,"Locatii"],[oa.USERS,"Personal"],[oa.CHANGE_PASSWORD,"Schimbare parola"],[oa.TEMPORARY,"Temporar"]]),ua=function(e){var a=e.tab,t=ca(),n=Object(X.a)(),r=Object(Y.a)(n.breakpoints.up("md"),{noSsr:!0}),c=Object(o.useState)(r),l=Object(f.a)(c,2),u=l[0],m=l[1],h=Object(p.g)(),E=Object(p.h)(),g=I(),b=g.username,w=g.role,v=g.browserHash,R=void 0===v?"":v,C=g.refreshToken,T=g.onLogout,N=g.setLoading;return i.a.createElement("div",{className:t.root},i.a.createElement(s.a,null),i.a.createElement(J.a,{position:"absolute",className:Object(V.a)(t.appBar,u&&t.appBarShift)},i.a.createElement(Z.a,{className:t.toolbar},i.a.createElement($.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:function(){m(!0)},className:Object(V.a)(t.menuButton,u&&t.menuButtonHidden)},i.a.createElement(ce.a,null)),i.a.createElement(B.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,className:t.title},sa.get(a)),i.a.createElement($.a,{color:"inherit"},i.a.createElement(K.a,{badgeContent:0,color:"secondary"},i.a.createElement(se.a,null))))),i.a.createElement(Q.a,{variant:"permanent",classes:{paper:Object(V.a)(t.drawerPaper,!u&&t.drawerPaperClose)},open:u},i.a.createElement("div",{className:t.toolbarIcon},i.a.createElement($.a,{onClick:function(){m(!1)}},i.a.createElement(me.a,null))),i.a.createElement(ee.a,null),i.a.createElement(ae.a,null,i.a.createElement(te.a,{button:!0,component:d.b,to:oa.DASHBOARD},i.a.createElement(ne.a,null,i.a.createElement(pe.a,null)),i.a.createElement(re.a,{primary:sa.get(oa.DASHBOARD)})),i.a.createElement(te.a,{button:!0,component:d.b,to:oa.MACHINES},i.a.createElement(ne.a,null,i.a.createElement(fe.a,null)),i.a.createElement(re.a,{primary:sa.get(oa.MACHINES)})),i.a.createElement(te.a,{button:!0,component:d.b,to:oa.INGREDIENTS},i.a.createElement(ne.a,null,i.a.createElement(ge.a,null)),i.a.createElement(re.a,{primary:sa.get(oa.INGREDIENTS)})),i.a.createElement(te.a,{button:!0,component:d.b,to:oa.LOCATIONS},i.a.createElement(ne.a,null,i.a.createElement(we.a,null)),i.a.createElement(re.a,{primary:sa.get(oa.LOCATIONS)})),w<3&&i.a.createElement(te.a,{button:!0,component:d.b,to:oa.USERS},i.a.createElement(ne.a,null,i.a.createElement(ve.a,null)),i.a.createElement(re.a,{primary:sa.get(oa.USERS)}))),i.a.createElement(ee.a,null),i.a.createElement(ae.a,null,i.a.createElement(oe.a,{inset:!0},"Utilizator: ",i.a.createElement("b",null,b)),i.a.createElement(te.a,{button:!0,component:d.b,to:oa.CHANGE_PASSWORD},i.a.createElement(ne.a,null,i.a.createElement(Re.a,null)),i.a.createElement(re.a,{primary:sa.get(oa.CHANGE_PASSWORD)})),i.a.createElement(te.a,{button:!0,onClick:function(){N&&N(!0),function(e,a){return new Promise((function(t,n){var r="";try{(r=String(localStorage.getItem("token")||""))||(r=String(sessionStorage.getItem("token")||""))}catch(i){console.error("Local Storage not supported")}var o={method:"POST",url:"".concat("https://virtusloop-mvm-api.herokuapp.com/").concat("api/auth/logout/"),headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8",Authorization:"Bearer ".concat(r),"X-Browser-Hash":e}};a&&(o.headers["X-Refresh-Token"]=a),S()(o).then((function(e){e&&201===e.status?(O(),t()):n()})).catch((function(){n()}))}))}(R,C).then((function(){T&&T(R),h.replace(oa.LOGIN,{from:E})}))}},i.a.createElement(ne.a,null,i.a.createElement(Ie.a,null)),i.a.createElement(re.a,{primary:"Deconectare"})))),i.a.createElement("main",{className:t.content},i.a.createElement("div",{className:t.appBarSpacer}),i.a.createElement(F.a,{maxWidth:"xl",className:t.container},function(){var e=sa.get(a);if(!e)return i.a.createElement(p.a,{from:E.pathname,to:oa.NOT_FOUND});switch(a){case oa.DASHBOARD:case oa.MACHINES:case oa.INGREDIENTS:case oa.LOCATIONS:return i.a.createElement("h1",null,e);case oa.CHANGE_PASSWORD:return i.a.createElement(ia,null);case oa.USERS:return w<3?i.a.createElement(na,null):i.a.createElement(p.a,{from:E.pathname,to:oa.FORBIDDEN});default:return i.a.createElement(p.a,{from:E.pathname,to:oa.NOT_FOUND})}}())))},ma=Object(W.a)((function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},card:{minWidth:275},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),da=function(){var e=ma(),a=I(),t=a.browserHash,n=void 0===t?"":t,r=a.onLogin,c=Object(o.useState)(!1),l=Object(f.a)(c,2),u=l[0],m=l[1],d=Object(o.useState)(!1),E=Object(f.a)(d,2),g=E[0],b=E[1],w=Object(o.useState)(!1),R=Object(f.a)(w,2),C=R[0],T=R[1],N=Object(p.g)(),A=(Object(p.h)().state||{from:{pathname:"/"}}).from;return i.a.createElement(F.a,{component:"main",maxWidth:"xs"},i.a.createElement(s.a,null),i.a.createElement("div",{className:e.paper},i.a.createElement(k.a,{className:e.avatar},i.a.createElement(U.a,null)),i.a.createElement(B.a,{component:"h1",variant:"h5"},"Conectare"),i.a.createElement("form",{className:e.form,onSubmit:function(e){e.preventDefault(),b(!0);var a=new FormData(e.currentTarget);(function(e,a,t,n){return new Promise((function(r,o){var i={method:"POST",url:"".concat("https://virtusloop-mvm-api.herokuapp.com/").concat("api/auth/login/"),headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8","X-Browser-Hash":t},data:{username:e,password:a}};S()(i).then((function(e){if(e&&201===e.status){var a=e.headers["x-token"],t=e.headers["x-refresh-token"];v(a,n),r({username:e.data.username,role:e.data.role,needNewPassword:e.data.needNewPassword,refreshToken:t})}else O(),o()})).catch((function(){O(),o()}))}))})(String(a.get("username")||""),String(a.get("password")||""),n,C).then((function(e){b(!1),r&&r(Object(h.a)({},e,{browserHash:n})),e.needNewPassword?N.replace(oa.NEW_PASSWORD,A):N.replace(A)})).catch((function(){b(!1),m(!0)}))}},i.a.createElement(D.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Nume",name:"username",autoComplete:"username",autoFocus:!0,onChange:function(){return m(!1)},disabled:g}),i.a.createElement(D.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Parola",type:"password",id:"password",autoComplete:"current-password",onChange:function(){return m(!1)},disabled:g}),i.a.createElement(L.a,{control:i.a.createElement(x.a,{value:"remember",color:"primary",onChange:function(e,a){T(a)},disabled:g}),label:"Tine-ma conectat"}),u&&i.a.createElement(y.a,{className:e.card},i.a.createElement(j.a,null,i.a.createElement(B.a,{variant:"body1",component:"p",color:"error"},"Nume sau parola incorecte! Incearca din nou."))),i.a.createElement(P.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit,disabled:g},g?i.a.createElement(z.a,null):"Conectare"))),i.a.createElement(M,null))},pa=Object(W.a)((function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},card:{minWidth:275},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));!function(e){e[e.INITIAL=-1]="INITIAL",e[e.SERVER_ERROR=0]="SERVER_ERROR",e[e.CLIENT_ERROR=1]="CLIENT_ERROR",e[e.SUCCESS=2]="SUCCESS"}(la||(la={}));var ha=function(){var e=pa(),a=I(),t=a.browserHash,n=void 0===t?"":t,r=a.refreshToken,c=a.onLogin,l=Object(o.useState)(la.INITIAL),u=Object(f.a)(l,2),m=u[0],d=u[1],E=Object(o.useState)(!1),g=Object(f.a)(E,2),b=g[0],w=g[1],O=Object(p.g)(),R=(Object(p.h)().state||{from:{pathname:"/"}}).from;return i.a.createElement(F.a,{component:"main",maxWidth:"xs"},i.a.createElement(s.a,null),i.a.createElement("div",{className:e.paper},i.a.createElement(B.a,{component:"h1",variant:"h5"},"Alege o noua parola"),i.a.createElement("form",{className:e.form,onSubmit:function(e){e.preventDefault();var a=new FormData(e.currentTarget),t=String(a.get("newPassword1")||""),o=String(a.get("newPassword2")||"");t===o?(w(!0),function(e,a,t){return new Promise((function(n,r){var o="",i=!0;try{(o=String(localStorage.getItem("token")||""))||(i=!1,o=String(sessionStorage.getItem("token")||""))}catch(l){i=!1,console.error("Local Storage not supported")}if(o){var c={method:"POST",url:"".concat("https://virtusloop-mvm-api.herokuapp.com/").concat("api/auth/reset_password/"),headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8",Authorization:"Bearer ".concat(o),"X-Refresh-Token":t,"X-Browser-Hash":a},data:{newPassword:e}};S()(c).then((function(e){if(e&&201===e.status){var a=e.headers["x-token"],t=e.headers["x-refresh-token"];v(a,i),n({username:e.data.username,role:e.data.role,needNewPassword:e.data.needNewPassword,refreshToken:t})}else r()})).catch((function(){r()}))}else r()}))}(o,n,r).then((function(e){w(!1),d(la.SUCCESS),c&&c(Object(h.a)({},e,{browserHash:n})),O.replace(R)})).catch((function(){w(!1),d(la.SERVER_ERROR)}))):d(la.CLIENT_ERROR)}},i.a.createElement(D.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"newPassword1",label:"Noua parola",type:"password",id:"newPassword1",autoComplete:"new-password",onChange:function(){return d(la.INITIAL)},disabled:b}),i.a.createElement(D.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"newPassword2",label:"Reintrodueti noua parola",type:"password",id:"newPassword2",autoComplete:"new-password",onChange:function(){return d(la.INITIAL)},disabled:b}),m!==la.INITIAL&&i.a.createElement(y.a,{className:e.card},i.a.createElement(j.a,null,i.a.createElement(B.a,{variant:"body1",component:"p",color:m===la.SUCCESS?"primary":"error"},m===la.SUCCESS?"Parola schimbata cu succes!":m===la.SERVER_ERROR?"Nu s-a putut schimba parola!":"Noua parola nu este identica la reintroducere!"))),i.a.createElement(P.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit,disabled:b},b?i.a.createElement(z.a,null):"Schimbare parola"))))},fa=function(){var e=I(),a=e.isLoading,t=e.username,n=e.needNewPassword;return a?i.a.createElement(A,null):i.a.createElement(p.d,null,i.a.createElement(p.a,{exact:!0,from:oa.HOME,to:oa.DASHBOARD}),i.a.createElement(p.b,{path:oa.LOGIN,render:function(){return t?i.a.createElement(p.a,{to:oa.DASHBOARD}):i.a.createElement(da,null)}}),i.a.createElement(Ea,{path:oa.NEW_PASSWORD,render:function(){return n?i.a.createElement(ha,null):i.a.createElement(p.a,{to:oa.DASHBOARD})}}),i.a.createElement(Ea,{path:oa.DASHBOARD,render:function(){return i.a.createElement(ua,{tab:oa.DASHBOARD})}}),i.a.createElement(Ea,{path:oa.MACHINES,render:function(){return i.a.createElement(ua,{tab:oa.MACHINES})}}),i.a.createElement(Ea,{path:oa.INGREDIENTS,render:function(){return i.a.createElement(ua,{tab:oa.INGREDIENTS})}}),i.a.createElement(Ea,{path:oa.LOCATIONS,render:function(){return i.a.createElement(ua,{tab:oa.LOCATIONS})}}),i.a.createElement(Ea,{path:oa.USERS,render:function(){return i.a.createElement(ua,{tab:oa.USERS})}}),i.a.createElement(Ea,{path:oa.TEMPORARY,render:function(){return i.a.createElement(ua,{tab:oa.TEMPORARY})}}),i.a.createElement(Ea,{path:oa.CHANGE_PASSWORD,render:function(){return i.a.createElement(ua,{tab:oa.CHANGE_PASSWORD})}}),i.a.createElement(p.b,{path:oa.FORBIDDEN,component:function(){return i.a.createElement("h1",null,"Forbidden")}}),i.a.createElement(p.b,{component:function(){return i.a.createElement("h1",null,"404 Not found")}}))},Ea=function(e){var a=e.path,t=e.render,n=Object(m.a)(e,["path","render"]),r=I().username?t:function(){return i.a.createElement(p.a,{to:{pathname:oa.LOGIN,state:{from:a}}})};return i.a.createElement(p.b,Object.assign({},n,{render:r}))},ga=function(){return i.a.createElement(d.a,{basename:"/mvm-web"},i.a.createElement(T,null,i.a.createElement(fa,null)))},ba=t(235),wa=Object(ba.a)({palette:{primary:{main:"#2B6CB0"},secondary:{main:"#2C7A7B"},error:{main:"#C53030"},background:{default:"#F7FAFC"}}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));window.requestIdleCallback=window.requestIdleCallback||function(e){var a=Date.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-a))}})}),1)},window.cancelIdleCallback=window.cancelIdleCallback||function(e){clearTimeout(e)},l.a.render(i.a.createElement(u.a,{theme:wa},i.a.createElement(s.a,null),i.a.createElement(ga,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[258,1,2]]]);